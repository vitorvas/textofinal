% ----------------------------------------------------------
% Revisão Bibliográfica
% ----------------------------------------------------------
\chapter{Revisão Bibliográfica}
\label{chap:rev}

%O acoplamento CFD-neutrônica. Motivação. Vantagens e desvantagens. 
%Nesse capítulo vão todas as referências importantes com explicações 
%de cada uma. 
%\section*{OpenFOAM}
%Por que usá-lo? Vantagens e desvantagens.

O ponto de partida deste capítulo deveria ser a descrição do problema de acoplamento,
a contextualização de sua aplicação e as razões que tornam tal problema fundamental
na simulação completa de um reator nuclear. Entretanto, no contexto dessa tese, é impossível
iniciar as discussões técnicas sem uma exposição, ainda que breve, da expressão que
aparece no título deste trabalho: \textit{software} livre.

A primeira utilização do termo \textit{software} livre (do inglês \textit{free software})
foi feita por Richard Stallmann. Não se sabe precisar quando o termo foi utilizado pela
primeira vez, mas tornou-se usual no início da década de 80 do século passado.
Apesar do significado ambíguo na língua inglesa - o próprio Stallmann faz questão
de explicar seu significado \cite{Stallman2002} - \textit{software} livre não deve
ser confundido com preço ou custo. Em definição do criador do termo, um \textit{software}
é livre para um usuário em particular se:
\begin{itemize}
\item O usuário tem liberdade de executar o programa, para qualquer propósito.
\item O usuário tem liberdade de modificar o programa para atender às suas necessidades.
  (Para tornar-se efetiva na prática, o usuário deve ter acesso ao código-fonte).
\item O usuário tem liberdade de restribuir cópias, gratuitamente ou não.
\item O usuário tem liberdade de distribuir versões modificadas do programa, de modo
  que a comunidade possa beneficiar-se das melhorias.
\end{itemize}

Uma vez definido o significado da expresão \textit{software} livre, cabe ressaltar que, do ponto de
vista do usuário, um \textit{software} definido com tal, pode não ser, na prática, livre.
Eventualmente, um determinado \textit{software} definido como livre pode distribuído sem
restrições a ser utilizado em sistemas
fechados. Desse modo, assim passa a integrar um sistema fechado, a parte livre do código não será mais livre do ponto de vista do usuário. Este é o caso de um \textit{software} em domínio público: pode ser utilizado sem restrições, inclusive ser incorporado a sistemas fechados.

Com isto em conta, faz-se necessária uma breve explicação do que são as licenças
de \textit{software} e como estas licenças definem as formas como devem se dar a utilização, distribuição, cópia, seção, etc. de determinado \textit{software}. Sendo assim,
já no escopo do projeto GNU \cite{Stallman1985} foi pensada a primeira forma
de licenciamento de \textit{software}
GNU. Esta licença é chamada GPL.

A licença GPL é apenas uma dentre várias, seja de \textit{software} livre ou
não. O objetivo da licença GPL é, ao mesmo tempo permitir liberdade do ponto de vista
do usuário do \textit{software}, mas impedir que o código-fonte seja usado em sistemas proprietários. Isso se dá obrigando sistemas que utilizem código
distribuído sob a licença GPL a ser distribuído sob a mesma licença.

Cabe ressaltar que um \textit{software} distribuído sob licença GPL é mais restritivo do
que um \textit{software} de domínio público, já que este último pode ser incorporado
a sistemas proprietários fechados, por exemplo. O \textit{software} GPL, por sua vez,
deve permanecer sempre livre. Os interessados em aprofundar os conhecimentos sobre
os diversos aspectos do \textit{software} de código aberto encontrarão sólidas informações
na referência \cite{Androutsellis2010}.

Mais de trinta anos depois do surgimento do movimento \textit{software} livre,
sua penetração no mundo da computação é completa. A maior parte tráfego de correio
eletrônico no planeta é feita por \textit{software} livre, por exemplo.  A título
de ilustração, em 2015, eram mais de 1 bilhão e 800 milhões de \textit{smartphones}
sendo utilizados no mundo. Destes, 82\% rodando um sistema operacional livre.

Era de se esperar que a penetração do \textit{software} livre chegaria também a outras
áreas, incluindo aplicações de missão crítica. A agência espacial norte-americana
utilizou \textit{software} livre no desenvolvimento de sistemas nos seus dispositivos
de exploração espacial \cite{Norris2004}.

Entretanto, a utilização de \textit{software} livre na indústria nuclear ainda é tímida.
Uma das razões é facilmente compreensível: o impacto de uma falha de \textit{software}
em uma aplicação nuclear pode ter resultados devastadores. Desse modo, o processo de
verificação e validação de sistemas de \textit{software} nessa indústria é extremamente
conservador. Somado-se a isso, o custo de verificação e validação de um novo \textit{software}
não é negligenciável. Tudo isso faz com que a adoção de ferramentas de \textit{software}
livre na área nuclear seja mais lenta que em outras áreas.

Essas dificultades, porém, são inferiores aos possíveis ganhos na utilização de
\textit{software} livre. Um grande exemplo dessa afirmativa é a ampla adoção
do \textit{software Serpent} \cite{Serpent2013}. Trata-se de um \textit{software}
de cálculos de física de reatores que utiliza o método de Monte Carlo. Apesar
de ter sua distribuição controlada, é distribuído com código-fonte. Em janeiro
de 2016, o \textit{Serpent} já era usado por mais de 460 usuários em 142 universidades
e centros de pesquisa em 36 países. Outra ferramenta, esta ainda pouco difundida,
desenvolvida tendo em vista as aplicações nucleares é o código milonga \cite{Theler2015}.
O milonga é um código do tipo volumes finitos e elementos finitos que resolve as equações
de difusão e transporte de nêutrons. Apesar de ainda estar em estágio inicial de
desenvolvimento, apresenta resultados promissores \cite{Theler2014b}, tendo sido
utilizado em cálculos de transientes da central nuclear de Atucha I.

Outra aplicação do \textit{software} livre na área nuclear é na educação. Seguindo na
mesma linha da afirmação de Jaakko Leppänen, da importância do desenvolvimento de
códigos na formação dos próximos especialistas na área nuclear \cite{Leppanen2015}, Benoit
Forget, do MIT, em uma avaliação da evolução do ensino física de reatores na sua instituição \cite{Forget2014}, é explícito ao observar os aspectos didáticos da
utilização de \textit{software} livre na educação. Dois dos códigos utilizados
no ensino de física de reatores no MIT após reformulação do currículo são o \textit{OpenMC}
\cite{Romano2013}, para cálculo de transporte de partículas pelo método de Monte Carlo e
o código \textit{OpenMOC}, que faz cálculos de transporte em 2D baseado
no método de características \cite{Boyd2014}.

Essas são considerações muito breves sobre o que se convencionou chamar
de \textit{software} livre. Este é, por si só, um tema que é assunto de estudos, pesquisas
e controvérsias. Entretanto, o fundamental neste ponto é perceber que esta ``nova'' forma
de desenvolvimento de software existe e, mesmo que timidamente, tem chegado à temática
nuclear. Este é, muito provavelmente, um caminho sem volta. E apesar da abordadem
superficial ao tema, passemos agora a outro conceito fundamental neste trabalho
de tese: o acoplamento neutrônico e termo-hidráulico.

O crescimento na capacidade de cálculo dos computadores pessoais permitiu não só o uso 
de técnicas mais elaboradas de cálculos termo-hidráulicos bem como seu uso em conjunto 
com códigos de cálculo neutrônico. Um dos primeiros trabalhos diretamente focados no 
acoplamento termo-hidráulico foi apresentado por \cite{Barber98}. Esse trabalho 
é essencialmente um relatório técnico, no qual o foco está na construção de uma interface 
genérica de acoplamento do código PARCS com códigos de termo-hidráulica. Apesar de não 
gerar resultados de simulações, esse documento evidencia a importância e o interesse 
no procedimento de acoplamento, além de fornecer preciosas informações acerca da 
implementação de estruturas de dados, manipulação de entrada e saída, troca de mensagens, 
uso de biblioteca de troca de mensagens PVM \cite{Geist94}, dentre outros pontos cruciais
da implementação de software. Cabe ressaltar que esta interface, 
chamada \textit{General Interface} é ainda usada pelo código PARCS nas suas versões mais 
recentes. 

Como mencionado no parágrafo anterior, o crescimento na capacidade de processamento
computacional 
fez com que os pesados cálculos de \textit{CFD} passassem a ser atraentes 
para a Engenharia Nuclear. Mais do que isso, o uso desses códigos passou a ser razão 
de preocupação no sentido de garantir a validade dos seus resultados. O relatório 
da Comissão Regulatória Nuclear (NRC) dos Estados Unidos de 2010 \cite[p.69]{NUREG2010}, 
ao sugerir as melhores práticas e métodos para a atividade de regulação, é bastante claro 
ao apontar a necessidade de tirar proveito da capacidade oferecida por códigos de \textit{CFD}, 
fornecendo inclusive sugestões de parceria com a indústria e universidades objetivando 
desenvolver simulações multidimensionais devidademente acompanhadas de validação e
verificação. O conteúdo desse relatório é, por si só, prova de que a utilização de 
códigos \textit{CFD} é, em definitivo, parte do processo de 
pesquisa e desenvolvimento de reatores nucleares. 

Um exemplo desse uso é a utilização de \textit{CFD} - nesse caso um código proprietário: 
\textit{ANSYS-CFX} - para modelar o fenômeno de ebulição subresfriada para o 
desenvolvimento de combustíveis nucleares \cite{Krepper2007}. Devido à capacidade 
dos códigos \textit{CFD} de simular detalhes do escoamento de acordo com a granularidade com que se
divide o domínio de simulação, nesse trabalho esta técnica é utilizada para avaliar 
o fenômeno de fluxo de calor crítico em um elemento combustível. As informações 
fornecidas pelo código \textit{CFD} em relação a fenômenos como rotação, \textit{cross flow} entre 
regiões adjacentes e concentração de bolhas (no caso em que se simule duas fases)
permitem identificar \textit{hot spots}, ou seja, regiões de especial interesse.
Essas simulações permitem avaliar o comportamento
de diferentes projetos de grades espaçadoras de elementos combustíveis quanto ao aspecto 
de segurança.

Um trabalho em conjunto entre pesquisadores do ISYRIM, UFMG e CDTN foi conduzido
com o objetivo de investigar o comportamento do reator TRIGA IPR-R1 por um código do tipo \textit{CFD} \cite{Martinez2012}. 
Nesse caso não houve tentativa de acoplamento, mas apenas a simulação simplificada 
do reator utilizando-se o \textit{ANSYS-CFX}. Um fluxo de calor 
foi fornecido para as paredes do combustível obedencendo à uma distribuição axial 
característica do combustível. Na análise quantitativa dos resultados, os autores 
informam que os resultados da simulação numérica apresentam boa concordância com 
dados experimentais coletados durante a operação do reator.

%O acoplamento propriamente dito é feito muitas vezes com um código neutrônico não-determinístico. 
%Esses códigos são baseados no método de Monte Carlo(\cite{mc}) e simulam o comportamento 
%do núcleo do reator através da simulação das histórias dos nêutrons. Isso consiste, basicamente, 
%em cálculos de probabilidades de absorção, choque, escape, etc. de um conjunto de nêutrons. 
%Um exemplo de trabalho de simulação do reator TRIGA IPR-R1 pelo método de Monte Carlo está em \cite{Silva2011}.
%Nesse caso, apenas a neutrônica é simulada.
O uso das técnicas de \textit{CFD} não ficou restrito aos \textit{softwares} ditos proprietários.
Hrvoje Jasak discorreu sobre as razões pelas quais um único \textit{software} monolítico
não era adequado para a solução dos vários problemas modeláveis em \textit{CFD}, tais como requisitos
de usuários específicos para um certo problema que poderiam envolver propriedades
experimentais, equações adicionais ao problema, ou acoplamento com pacotes externos.
O autor ressalta, ainda, que para diferentes problemas, diferentes formas de discretização
e soluções numéricas são necessárias. Além das suas críticas às dificuldades de uso e
não-flexibilidade dos códigos fechados, propôs uma solução: uma biblioteca
orientada a objetos para simulações numéricas escrita em linguagem C++ e, mais do que tudo,
licenciada com \textit{software} livre \cite{Jasak2007} chamada \textit{OpenFOAM}.
Neste trabalho o autor também desfaz as polêmicas sobre o desempenho de códigos escritos
em C++ e demonstra como as equações são modeladas dentro do \textit{OpenFOAM}. Um
exemplo é a equação da energia cinética turbulenta no modelo RANS
\begin{equation}
  \frac{\delta k}{\delta t} + \nabla . (\mathbf{u}k) - \nabla . [(\nu + \nu_{t})
    \nabla k] = \nu_t \left[ \frac{1}{2}(\nabla \mathbf{u} + \nabla \mathbf{u}^T)\right]^2 - \frac{\epsilon_0}{k_0}k
\end{equation}
que é representada como código no \textit{OpenFOAM} do seguinte modo:
\begin{lstlisting}[language=c++]
solve
(
   fvm::ddt(k)
 + fvm::div(phi, k)
 - fvm::laplacian(nu() + nut, k)
== nut*magSqr(symm(fvc::grad(U)))
 - fvm::Sp(epsilon/k, k)
);  
\end{lstlisting}

Estes exemplos ajudam a ilustrar a relativa simplicidade - de acordo com o autor, mesmo
alguém com conhecimento limitado em programação e sem referência à programação orientada
a objetos em C++ é capaz de entender por alto o trecho apresentado - da modelagem
de equações diferenciais no \textit{OpenFOAM}.

Vale ressaltar que, devido ao custo computacional dos cálculos \textit{CFD}, seu uso na indústria
é, se comparada a outros métodos de simulação termo-hidráulica, bastante recente.
Como não poderia ser diferente, o mesmo ocorre na indústria nuclear. Um artigo que
veio de forma definitiva atestar a importância dos cálculos \textit{CFD} na indústria nuclear
foi apresentado por Emilio Baglietto \cite{Baglietto2011}. Neste artigo, o autor afirma
que o uso de \textit{CFD}, usado só ou combinado com códigos neutrônicos e ferramentas
de análise, aumentou a capacidade e disponibilidade dos reatores nucleares
atualmente em operação. Ele afirma,
ainda, que tal tecnologia de análise está ajudando no desenvolvimento dos reatores
de quarta geração, especialmente neste caso, em que dados experimentais e operacionais
estão menos disponíveis. Vendedores e operadores de reatores utilizarão muito mais
modelagem, simulação e computação para determinar como reatores e seus componentes
irão se portar quando em operação. O autor é categórico ao afirmar que ``em um
período de 20 anos, a indústria passará dos métodos convencionais baseados em
correlações experimentais ao uso de \textit{CFD} para pequenos componentes, grandes componentes
e análise de uma planta completa''. 

Entretanto, para obter resultados os mais realistas possível, é necessário simular 
tanto os fenômenos termo-hidráulicos quanto neutrônicos. Isso 
se deve ao fato de que os principais fatores que influeciam na distribuição do fluxo de 
nêutrons no núcleo de um reator nuclear são as propriedades do moderador e refrigerante. No caso de um
reator do tipo PWR, a água exerce ambos os papéis, sendo também usada grafita para 
a moderação. Pequenas variações na temperatura, densidade e composição 
da água podem mudar consideravelmente o fator de multiplicação de nêutrons ($k_{eff}$). Daí a importância e 
a necessidade de acoplar os cálculos termo-hidráulicos - as variações nas propriedades da água - com as variações 
no fluxo neutrônico.

O acoplamento das simulações de diferentes fenômenos físicos tem sido também chamado de
\textbf{multifísica}. 
Uma definição prática para multifísica ou física-acoplada é dada por Paul Lethbridge \cite{Lethbridge2005}, definindo que 
a multifísica é, em essência, a análise de fenômenos físicos distintos de forma combinada.

No texto desta tese, 
por conveniência, a palavra acoplamento será usada tanto em referência ao processo de análise dos fenômenos físicos conjuntamente 
quanto em referência à implementação do software para essa tarefa. Nos casos em que possa haver ambiguidade, 
a definição será explicada de modo a não deixar margens a dúvidas.

Vale ressaltar, já que nos referimos à implementação do acoplamento em software, que uma aplicação multifísica 
pode levar entre 4 e 6 anos para ser efetivamente útil, podendo chegar a uma vida útil de várias décadas 
\cite{Graham2004}. Isto posto, é possível concluir que o esforço em construir o acoplamento é compensado 
pela possibilidade de uso do código durante vários anos.

Ainda sobre a importância recente dos cálculos neutrônicos e termo-hidráulicos acoplados, foi iniciado em 2012
no Centro de Pesquisas Técnicas VTT (Finlância) o projeto \textit{Numerical Multi-Physics (NUMPS)} \cite{Leppanen2015}.
Dentre seus objetivos, estão o desenvolvimento do código de física de reatores Serpent, que utiliza o método de
Monte Carlo e do código PORFLO, do tipo \textit{CFD}. Esse desenvolvimentooferece oportunidades para a educação das novas
gerações de especialistas, não apenas com compreensão de teoria e métodos, mas também com entendimento ao nível de
código-fonte das ferramentas de cálculo.

% Citar os trabalhos do IVANOV aqui...
Uma vez apresentados o que são os códigos \textit{CFD} e algumas de suas aplicações no domínio nuclear e definido o significado do acoplamento no contexto desse trabalho de tese, serão apresentados os mais importantes 
trabalhos sobre o acoplamento. Talvez o mais importante trabalho relacionado ao acoplamento 
neutrônico/termo-hidráulico seja o de Ivanov \cite{Ivanov2007}. Nele são analisados e classificados diferentes tipos de 
acoplamento, seus componentes e suas aplicações. Os diversos parâmetros do acoplamento são esquematicamente dividos em: 
\begin{enumerate}
\item \textbf{Forma de acoplamento}: externo, quando o código neutrônico é combinado com parte do código termo-hidráulico, 
geralmente na forma de condições de contorno, e então acoplado ao sistema termo-hidráulico completo. O acoplamento 
é definido como interno quando a neutrônica é integrada ao modelo de transferência de calor do sistema termo-hidráulico. 
Em outras palavras, o acoplamento interno é uma implementação multifísica. Deve-se dizer que não há, na literatura, uma
concordância completa sobre a nomeclatura para a forma de acoplamento. 
\item \textbf{Abordagens de acoplamento}: integração em série ou processamento em paralelo. Na integração em série o algoritmo 
para cálculo neutrônico é integrado como uma rotina ao sistema termo-hidráulico e então executado sequencialmente 
após os cálculos termo-hidráulicos. Na abordagem de processamento em paralelo, geralmente a troca de dados é 
intermediada por um sistema de troca de mensagens como PVM \cite{Geist94} ou MPI \cite{Quinn2004}. Nesse caso, os 
módulos de neutrônica e termo-hidráulica têm capacidade separada de execução e resposta, o que permite uma execução 
mais eficiente do ponto de vista computacional.
\item \textbf{Sobreposição espacial de malhas}: pode ser fixo, quando um canal termo-hidráulico representa um canal neutrônico, 
ou flexível, quando são usados ou especificados esquemas de mapeamento. Um esquema avançado de mapeamento 
e interpolação de malhas \cite{Beaudoin2008} é implementado em alguns dos modernos códigos de \textit{CFD}. As diversas implicações 
do mapeamento de malhas para a simulação serão apresentadas oportunamente.
\item \textbf{Algoritmos de controle de \textit{time-step}}: os transientes neutrônicos são geralmente muito mais rápidos que 
os transientes termo-hidráulicos. A utilização de um único \textit{time-step} longo pode levar à não detecção de transientes 
rápidos e no caso oposto ao desperdício de recursos computacionais ao se simular eventos indistinguíveis repetidamente.
\item \textbf{Acoplamento numérico}: o autor se refere nesta classificação ao tempo de troca de informações entre o modelo 
neutrônico e termo-hidráulico. Pode ser explícito, semi-explícito e implícito, dependendo da forma como cada esquema 
realiza o cálculo das variáveis do \textit{time-step} atual baseado em variáveis do \textit{time-step} atual ou 
anterior.
\item \textbf{Esquemas de convergência do acoplamento}: definidos de acordo com a forma com que a simulação é considerada 
finalizada. Se há apenas uma estimativa para a convergência de ambos os códigos, o esquema é considerado fracamento 
acoplado, por exemplo.  
\end{enumerate}

Em relação ao último item, poucos autores se dedicam a uma análise sistemática da forma como se
dá a convergência nos cálculos acoplados. Usualmente são apenas apresentados os esquemas
de convergência e o foco das análises se concentra nos resultados dos cálculos acoplados.
Zerkak \cite{Zerkak2015}, por sua vez, faz uma revisão dos métodos de acoplamento com
foco em como melhorar a convergência das atuais técnicas de acoplamento. O autor faz uma
análise pormenorizada da técnica de \textit{operator splitting} e várias de suas melhorias,
dentre vários outros esquemas numéricos de solução de \textit{PDE's}. Sua análise visa
uma avaliação de vantagens e desvantagens dos métodos númericos em relação à eficiência
computacional, convergência e esforço de implementação e modularidade, sempre com vistas
à análise de reatores nucleares.

O autor ainda comenta a importância da geração de seções de choque adequadas aos transientes esperados na 
simulação acoplada e sua interdependência. A geração de seções de choque, apesar de não ser escopo desta tese,
foi realizada para a obtenção dos coeficientes para a solução da equação de difusão para dois grupos de nêutrons.
Uma breve explicação de como seções de choque para poucos grupos podem ser geradas pode ser encontrada no
artigo de Friedman \cite{Friedman2013}. Cabe ressaltar que um grande número de trabalhos encontrados
na literatura tem utilizado repetidamente o código \textit{Serpent} \cite{Serpent2013} para
a geração de seções de choque, tanto para cálculos estocásticos quanto determinísticos \cite{Jareteg2014}. O leitor interessado nos detalhes dos métodos utilizados no \textit{Serpent} na
preparação de seções de choque para os cálculos de transporte de nêutrons pode encontrar mais informações no trabalho de Leppänen \cite{Leppanen2009}.

Em breve resumo, o trabalho de Dorval \cite{Dorval2015} investiga
a geração de seções de choque para poucos grupos a partir do código \textit{Serpent} para
o cálculo neutrônico de reatores rápidos refrigerados a sódio. Além dos coeficientes de
difusão padrão gerados pelo \textit{Serpent}, é proposto um novo método para cálculo de
coeficientes de difusão direcionais. 

Confirmando o atual interesse em cálculos \textit{CFD} no domínio nuclear, um trabalho de simulação envolvendo
neutrônica e termo-hidráulica com uso de \textit{CFD} propõe a simulação de reatores avançados refrigerados
a gás \cite{Hossain2011}. O modelo utilizado 
para a simulação neutrônica foi o de cinética pontual devido à sua simplicidade. No modelo 
de cinética pontual assume-se que a forma do perfil do fluxo de nêutrons durante um transiente 
não varia, mas apenas os valores do fluxo variam com o tempo. A variação no fluxo é dada 
pelo balanço entre nêutrons produzidos e perdidos, considerando seis classes de precursores 
para nêutrons atrasados. O desenvolvimento matemático leva a um sistema de sete equações diferenciais 
ordinárias, conhecidas como equações de cinética pontual. A implementação da solução desse sistema 
é, nesse caso, feito dentro do código termo-hidráulico utilizado (\textit{TH3D}).

Em outro trabalho que se utilizou de \textit{CFD} \cite{Yan2011}, foi simulado o comportamento do escoamento em um feixe de elementos 
combustíveis e espaçadores utilizando-se de \textit{CFD} acoplado à neutrônica. A neutrônica 
simulada é baseada no \textit{method of characteristic}, que evita a necessidade de geração 
de constantes para poucos grupos \textit{a priori}. A abordagem usada no 
acoplamento é do tipo externa, com o código neutrônico DeCART e o código termo-hidráulico 
STAR-CCM+ executando sequencialmente e escrevendo e lendo arquivos em disco em um 
diretório comum. São dois critérios para finalizar a simulação: o código DeCART se baseia 
na convergência da fonte de fissão, enquanto o código STAR-CCM+ no resíduo da energia. No que toca à 
discretização espacial (sobreposição espacial de malhas), é usado um mapeamento entres as malhas 
utilizadas nos dois códigos. Apesar de diferenças nas malhas, as fronteiras materiais, ou seja, geometria, 
fronteira e posição de diferentes materias são equivalentes em ambos os modelos.

As conclusões apresentadas reiteram a importância da técnica de \textit{CFD} na indústria nuclear. Em particular, 
a capacidade de verificar os efeitos da grade misturadora na temperatura e densidade do refrigerante 
levando-se em consideração os efeitos neutrônicos. Nas palavras do autor, esse acoplamento 
``permite um melhor entendimento da margem de DNB (\textit{Departure from Nucleate Boiling})''.
O autor finaliza apontando o interesse em incrementar a simulação 
agregando outros aspectos físicos, como um modelo de corrosão, um modelo de geração do particulado, 
um modelo de interação revestimento/pastilha e outros. Percebe-se aqui que as diversas aplicações 
de multifísica já são esperadas e inevitáveis, e num futuro mais do que próximo.

Corroborando com a ideia da importância dos cálculos acoplados, Faghihi faz uma análise
dos diversos tipos de códigos usados para cálculos termo-hidráulicos no que se refere à
forma como os sistemas são modelados (códigos de sistemas, códigos de sub-canais e códigos
do tipo \textit{CFD}) e, de forma semelhante, para os códigos neutrônicos \cite{Faghihi2011}. Neste
trabalho o autor é mais ousado e, além de descrever alguns conceitos de acoplamento
neutrônico e termo-hidráulico, propõe o uso de redes neuronais treinadas sob dados de
outras simulações para a solução do fluxo neutrônico em reatores do tipo LWR.

Talvez o mais completo trabalho relativo ao acoplamento neutrônico-termo-hidráulico com uso do 
\textit{CFD} \textit{OpenFOAM} seja a tese de Klas Jareteg \cite{Jareteg2012}. Nela, o acoplamento é feito usando o mesmo 
software para a simulação termo-hidráulica e neutrônica. A metodolgia utilizada pode ser brevemente 
resumida em alguns passos principais: 1) criação de uma malha adequada, 2) discretização das 
equações descrevendo o problema, 3) definição das condições de contorno, 4) geração dos 
parâmetros neutrônicos (por exemplo, seções de choque macroscópicas) e 5) solução do 
problema neutrônico e termo-hidráulico de forma acoplada. O autor usa um dos modelos de solução presentes no 
software de \textit{CFD} \textit{OpenFOAM} \cite{OpenFOAM2013} e 
altera esse modelo que simula um escoamento turbulento de um fluido compressível com transferência de energia
por radiação térmica (\texttt{buoyantSimpleRadiationSolver}) adicionando uma implementação da equação de difusão multi-grupos 
ao modelo. Isto é feito utilizando a capacidade geral de discretização e solução de equações bem como os algorimos 
para solução numérica já presentes no \textit{OpenFOAM}. Dentre suas conclusões, estão que o acoplamento iterativo 
utilizado é funcional e estável, a solução para a neutrônica necessitou de menos iterações para convergir 
do que que a solução pressão-velocidade e que a termo-hidráulica precisa de malhas mais refinadas do que a solução 
neutrônica. A qualidade desse trabalho e muitas das soluções adotadas servem como referências às implementações 
e simulações a serem feitas nesta tese.

O referido trabalho de tese deu origem a um artigo \cite{Jareteg2014} no qual o acoplamento
neutrônico/termo-hidráulico é classificado como interno e é utilizada uma malha
refinada. O objetivo deste artigo é provar que
este acoplamento é factível e gera resultados com um nível de detalhes sem precedentes. Além
disso, os autores apontam que cálculos com malhas menos refinadas geram discrepâncias
de até 0,5\% na potência por vareta e várias dezenas de \textit{pcm} no fator de multiplicação.
Os autores justificam, ainda, que apesar de a neutrônica não necessitar de uma malha
tão detalhada quando necessita a termo-hidráulica, seu uso se justifica pela não necessidade
de interpolações ou mapeamentos entres os elementos da malha. Além disso, como trata-se
de um acoplamento interno, não há necessidade de transferência de dados, poupando-se
tempo de processamento.
Neste trabalho o problema é tratato como de regime permanente, bem como o problema escopo
desta tese.

O \textit{OpenFOAM} também foi a ferramenta escolhida por pesquisadores do Paul Sherrer
Institut para reduzir os esforços de desenvolvimento ao prover rotinas de discretização
e capacidade de execução em paralelo de soluções de equações diferenciais. A partir
de \textit{solvers} disponíveis no \textit{OpenFOAM} foi implementado um \textit{solver}
multifísica batizado \textit{General Nuclear Foam - GeN-Foam} \cite{Fiorina2015}.
Este \textit{solver}
possui a capacidade de resolver escoamentos compressíveis ou incompressíveis baseados
no modelo de turbulência padrão $\kappa-\epsilon$, sendo também capaz de resolver
problemas em malhas menos refinadas utilizando o modelo de meios porosos. Tem, ainda,
implementado um \textit{sub-solver} de termo-mecânica e outro \textit{sub-solver} para
a solução da equação de difusão para multi-grupos. Este último, provê ainda a capacidade
de resolver problemas com malhas móveis e tem implementados métodos de leitura de seções
de choque geradas pelo código Serpent \cite{Serpent2013}. Os autores classificam
o acoplamento implementado como semi-implícito e como são usadas malhas diferentes para
os modelos termo-hidráulico, termo-mecânico e de difusão de nêutrons, é feito um mapeamento
consistente entre as três malhas através do uso de um algoritmo de peso-célula-volume
implementado pelo próprio \textit{OpenFOAM} \cite{OpenFOAM2015}. A aplicação inicial deste
\textit{solver} foi na simulação do reator rápido a sódio europeu (ESFR). Mesmo com as
simplificações no modelo, as respostas numéricas para as simulações de dois transientes
testados ficaram próximas das obtidas pelas simulações de referências feitas com o
código TRACE.

Uma das razões do uso do acoplamento, cujo objetivo é obter dados mais precisos e realistas, é na 
análise de segurança de reatores. Em projetos de reatores inovadores já são feitos cálculos de multifísica para 
análise de acidentes. No trabalho de \cite{Lazaro2013}, um reator de IV geração refrigerado a sódio 
é simulado de forma acoplada. Códigos já usados na análise de reatores resfriados a água leve são adaptados 
para o uso em reatores de nêutrons rápidos resfriados a sódio. Um ponto-chave, segundo o autor, é ser capaz 
de simular os fenômenos presentes na operação de reatores em três dimensões. Isso se justifica, ainda nas 
palavras do autor, devido a possíveis componentes assimétricos em transientes hipotéticos e que 
a modelagem unidimensional com cinética pontual não é capaz de reproduzir. Assim como em vários trabalhos 
sobre o tema de acoplamento, o código usado para a geração de seções de choque homogeneizadas 
foi o \textit{Serpent} \cite{Serpent2013}. Nesse trabalho, o código \textit{Serpent} foi ainda usado 
para cálculo neutrônico do núcleo e validação do código PARCS \cite{PARCS2006}. Sua conclusão nesse trabalho 
é de que as adaptações feitas nos códigos levaram a resultados consistentes, mas que ainda há trabalho 
a ser feito para a simulação tridimensional completa desse tipo de reator.

O pioneirismo do grupo da universidade de Chalmers, em Gotemburgo - Suécia, encabeçado
por Christophe Demazière, além dos já citados trabalhos \cite{Jareteg2012, Jareteg2014},
também se refletiu em outras formas de acoplamento. Desta vez, sem o uso do \textit{OpenFOAM},
foi implementada uma ferramenta para estimar flutuações no fluxo neutrônico, temperatura
do combustível, densidade do moderador e velocidade do escoamento em um reator do tipo PWR
\cite{Larsson2012}. Este tipo de ferramenta visa captar as flutuações em parâmetros
essenciais do funcionamento do reator e, então, encontrar eventuais anomalias. A validação
foi feita com dados de um reator PWR comercial e simulações feitas com os códigos
RELAP e PARCS acoplados bem como com o \textit{CFD} comercial Fluent. É importante ressaltar que
estas simulações foram feitas para um modelo tridimensional e para cada nó em cada canal,
ou seja, um acoplamento um-para-um entre neutrônica e termo-hidráulica.

A importância dada aos cálculos de neutrônica e termo-hidráulica acoplados
é ratificada no trabalho de Jaakko Leppänen sobre o código de Monte Carlo
Serpent \cite{Leppanen2012}. Até pouco tempo atrás, a exigência computacional dos códigos
de Monte Carlo impossibilitavam seu uso em cálculos acoplados e iterativos. O aumento
quase exponencial na capacidade computacional jogou por terra tais restrições.
Com os códigos de Monte Carlo executando mais rapidamente - em especial o código Serpent2 -
o autor optou por oferecer uma interface acoplável por padrão neste \textit{software}.
No trabalho em questão, é implementada uma interface multifísica para acoplamento com um
código termo-hidráulico externo. Atualmente, o Serpent2 conta com uma interface para utilizaçao
de malhas não-estruturadas no formato \textit{OpenFOAM}.

Os exemplos de tempo investido em sistemas de cálculos acoplados não cessam. O grupo
de métodos multifísica do \textit{Idaho National Laboratory} desenvolveu o sistema
\textit{MOOSE: Multiphysics Object Oriented Simulation Environment}. Este sistema objetiva
a solução de problemas fortemente acoplados ao mesmo tempo em que fornece suporte para
o desenvolvimento de, segundo o autor, ``engenharia de aplicações de análise''
\cite{Gaston2009}. O foco do seu desenvolvimento vai além do desempenho:
\begin{itemize}
\item Desenvolvido objetivando execução em paralelo \textbf{massiva} e escalabilidade,
  além de facilidade de uso das aplicações;
\item Utiliza-se de modernos princípios de desenvolvimento de \textit{software}, de modo
  a permitir manutenção e extensões de forma econômica;
\item As aplicações devem obedecer rigorosas especificações de verificação e validação,
  implicando no mesmo tipo de rigor para o próprio sistema.
\end{itemize}
Estas características tornam o \textit{MOOSE} a plataforma de computação multifísica
de base do \textit{Idaho National Laboratory}, oferecendo suporte ao desenvolvimento
de projetos e códigos de análise paralelos e multidimensionais.

De carona na plataforma \textit{MOOSE}, não tardaram a aparecer aplicações para
este \textit{framework}. Uma aplicação para a solução da equação de transporte
de nêutrons em elementos finitos tridimensional, chamada \textit{RATTLES$_{N}$AKE},
foi implementada. Para a queima de combustível nuclear, nos mesmos moldes e
também utilizando elementos finitos tridimensional, foi criada a aplicação
\textit{BISON}. Esta aplicação resolve implicitamente as equações termo-mecânicas
acopladas, oferecendo modelos para inchaço e densificação do combustível, dentre outros.
Sendo ambas as aplicações desenvolvidas sobre a plataforma \textit{MOOSE}, o acoplamento
entre ambas foi direto \cite{Gleicher2014}.
Os resultados dos cálculos acoplados para uma vareta combustível foram validados por uma simulação com o código Monte Carlo \textit{Serpent},
os cálculos acoplados feitos com malhas de diferentes granularidades, e apontaram boa
concordância com os resultados do \textit{Serpent}.

Apesar de não ser um sistema \textit{CFD}, mas de elementos finitos, a razão de
apresentar tanto a plataforma \textit{MOOSE} quanto um exemplo de suas aplicações
acopladas é o de atestar que a solução de problemas do domínio nuclear de forma
acoplada não é hoje uma possibilidade, mas efetivamente uma realidade.

Nesse capítulo tentou-se dar uma visão geral sobre o que é \textit{software} livre e do
seu uso nas diversas áreas do conhecimento humano, inclusive em situações de aplicações
críticas. Chamou-se atenção para a importância que vêm ganhando as técnicas \textit{CFD} na
indústria nuclear e, sobretudo, seu recente uso na termo-hidráulica acoplada aos cálculos
neutrônicos. A lista de aplicações citadas é certamente não-exaustiva e há razões para
acreditar o uso de \textit{CFD} continuará a crescer, limitado apenas pela criatividade
das suas aplicações. E não há razão para acreditar que essa última encontrará barreiras
facilmente.

%Nesse capítulo foram apresentados alguns trabalhos sobre o tema do acoplamento neutrônico/termo-hidráulico 
%com diversas aplicações. Alguns desses trabalhos, são referências no trabalho que está sendo desenvolvido 
%nesta tese e cuja proposta será apresentada com detalhes no próximo capítulo.



%Teste de listagem de programa.
%\lstinputlisting[language=c++, firstline=127, lastline=143]{/home/vitors/workspace/thesisChtMultiRegionFoam/chtMultiRegionSimpleFoam/solid/createSolidFields.H}

%Teste copiando o texto em si.
%\lstset{customc++}
%\begin{lstlisting}
%  if(Pstream::parRun())
%  {
%    fileName cellCorr(runTime.rootPath()+"/"+runTime.caseName()+
%    "/constant/"+solidRegions[i].name()+"/polyMesh");
%    
%    // Read cellProcAddressing for each processor
%    solidList[i][Pstream::myProcNo()] = labelIOList(IOobject
%    (
%        "cellProcAddressing", // Filename
%        cellCorr,
%        solidRegions[i],	// Registry
%        IOobject::MUST_READ, 	// Read option
%        IOobject::NO_WRITE 	// Write Option
%    ));
%    
%    // Create a mapping from each processor to the solidListsRegions
%  }
%\end{lstlisting}


%Tesse de referências usando o \textsf{abntex2} e o 
%pacote \textsf{abntex2cite}itando
%\cite{Janosy2011}. Fala de simulação de forma geral, talvez a ser citado na metodologia.



%\cite{Baglietto2011}.

%Citar \cite{Gleicher2014} que faz acoplamento Bison-Rattlesnake.
%\cite{Beaudoin2008}. CITADO
% Sobre TRIGA tem o trabalho do 
%\cite{Khan2011}. O turco fez benchmarks sobre o TRIGA dele em 
%\cite{Turkmen2013}. Artigo mais matemático, acoplamento totalmente 
%implícito pelo \cite{Pope2008}. O fodão da área é o \cite{Ivanov2007}.
%Os caras da Westinghouse mexem na grade do André \cite{Yan2011} 
%enquanto os iranianos trabalham com o cálculo de parâmetros 
%cinéticos em \cite{Jahanbin2012}. É importante lembrar que um dos 
%autores de \cite{Barber98} é autor de outro dos trabalhos citados. 
%O nome dele é \textit{Downar}. Artigo sobre modelagem \textit{CFD} do TRIGA IPR-R1 
%em \cite{Martinez2012}. Outro paper que descreve o uso de códigos diversos 
%para modelagem e estudo do núcleo de um PWR é: \cite{Huda2011}. 

%\cite{Ragusa2009} é um dos trabalhos com maior detalhamento do 
%acoplamento, focando em controle do \textit{time-step}. Os chineses 
%fizeram um acoplamento e falaram da geometria e usaram fluxograma 
%em \cite{Yang2011}. Um acoplamento entre o MCNPX e o COBRA foi 
%feito em \cite{Vazquez2012}. Um dos poucos trabalhos em que 
%é feita a análise da propagação de erros em processos de software 
%é: \cite{Sarshar2011}. Um trabalho focado na matemática das 
%equações diferenciais da termo-hidráulica é o \cite{Mousseau2007}.
%Vários autores citados em outros trabalhos nesta tese estão juntos 
%em \cite{Barber99} descrevendo os primeiros acoplamentos entre 
%PARCS, RELAP5 e TRAC-M. Uma parte do relatório da comissão regulatória 
%norte-america \cite{NUREG2010} aponta a importância de investir 
%tempo em termo-hidráulica e neutrônica, o papel do regulador nisso 
%e dá justificativas para o tema dessa tese.

%\cite{Aumiller2001} propõe 
%um acoplamento explícito RELAP/\textit{CFD} e conclui que o \textit{CFD} é capaz de 
%calcular a multifísica. A história do código WIMS e a descrição 
%da sua versão 9 estão em \cite{Newton2002}. Nesse trabalho seus 
%resultados são comparados com um código de Monte Carlo. Um paper 
%muito difícil (conteúdo matemático pesado) mas também muito importante 
%é o do \cite{Demaziere2011}. Nele é proposto um código neutrônico 
%multi-propósito, para uso em pesquisa e educação. O trabalho 
%de \cite{Pourgol-Mohamad2011} é focado no tratamento estruturado 
%do modelo de incerteza em códigos neutrônicos e termo-hidráulicos. 
%Citando os livros, o primeiro é o livro base para uso de \textit{CFD}: 
%\cite{Versteeg2007}, no qual são dadas as bases da técnica.
%Outro livro sobre \textit{CFD}, com uma abordagem básica da matemática 
%é o \cite{Anderson95}. Um referência importante no trabalho 
%com o MPI é o livro do \cite{Quinn2004}. E a base para o trabalho 
%de neutrônica está em \cite{Hebert2009}.

%Na elaboração da tese são usados diversos softwares. As informações são 
%geralmente obtidas dos manuais. O código de Monte Carlo com potencial 
%de ser usado é o \cite{Serpent2013}. O código mais importante de 
%acordo com o projeto de tese é o PARCS. Seu manual está divido em 
%manual do usuário \cite{PARCS2006}, manual do programador \cite{PARCS2004} 
%e o manual de teoria \cite{PARCS2004b}. O OpenFOAM é o outro principal 
%software utilizado nesta tese. São também três os manuais usados, sendo 
%o primeiro \cite{OpenFOAM2013} o do usuário, o segundo o guia do 
%programador \cite{OpenFOAM2013b} e a documentação do código 
%em formato eletrônico \cite{OpenFOAM2015}.
