% ----------------------------------------------------------
% Aplicação
% ----------------------------------------------------------
\chapter{Aplicação}
\label{chap:aplicacao}

De modo a avaliar o sistema de \textit{software} desenvolvido com base na metodologia apresentada, 
foi desenvolvido um modelo simplificado \textbf{baseado} em um sistema físico existente, no caso,
o reator TRIGA IPR-R1 do CDTN. A elaboração deste modelo levou em consideração os aspectos físicos
de um único elemento combustível - envolvido por certa quantidade de água - do reator TRIGA
em condições de utilização usuais de trabalho.

\section{Reator TRIGA IPR-R1}
\label{sec:triga}

%Nesta seção, será brevemente descrito o reator TRIGA IPR-R1, utilizado como referência para a
%construção do modelo simplificado utilizado na avaliação do sistema acoplado implementado nesta
%tese.

Os reatores do tipo TRIGA\textregistered (\textit{Training, Research and Isotopes}),
desenvolvidos pela \textit{General Atomics} (GA), são os mais utilizados
reatores de pesquisa no mundo (66 instalações em 24 países). Seu projeto data dos anos 50 e é
projetado para utilizar combustíveis de hidreto de zircônico e urânio, bem como simplicidade
de operação e manutenção. Além disso, tem como característica um amplo coeficiente negativo
de reatividade-temperatura \cite{Veloso2005}. Isso faz com os reatores do tipo TRIGA sejam
intrínsicamente seguros, tornando-os excelentes opções para uso em atividades de treinamento
e pesquisa.

% TRIGA CDTN
% Uma figura dele
% Falar do elemento mais quente e qual foi escolhido


\section{Modelo: fatores limitantes}
\label{sec:lim}

O modelo de avaliação do acoplamento foi concebido de acordo com as restrições impostas pelos sistemas
utilizados na implementação do acoplamento. O \textit{OpenFOAM}, por se tratar de um sistema mais maduro
e com ampla rede de usuários, não impôs
restrições ao problema em termos de tamanho de malha a ser utilizada. Entretanto, a versão
do \textit{OpenFOAM} utilizada,
apresenta um erro (\textit{bug}, no jargão da Ciência da Computação) na implementação da resistência
de contato, o que inviabilizou a simulação do \textit{gap} existente no combustível. Sendo essa a
primeira simplificação necessária em relação ao combustível do reator TRIGA IPR-R1.

No tocante ao \textit{milonga}, as restrições foram maiores. Foram duas as grandes limitações impostas
pelo \textit{milonga} na definição de um modelo mais complexo e computacionalmente exigente. A primeira
é relativa a execução de forma sequencial. Como o \textit{milonga} não é ainda capaz de executar de
forma paralela, o tamanho da malha a ser utilizada fica restrito à memória disponível.
O tamanho da malha também implica diretamente no tempo de execução.
Além disso, o \textit{milonga} ainda não é capaz de lidar com elementos prismáticos de forma confiável, limitando a
geração da malha por extrusão a utilização de elementos hexahédricos.
Como no caso de um combustível do tipo TRIGA o revestimento tem espessura ordens de grandeza
menor do que o raio do combustível, a não-utilização de elementos prismáticos impactou na geração
de uma malha mais refinada.

A segunda restrição imposta pelo \textit{milonga}, também em razão de um \textit{bug}, está na função
de acesso por coordenada espacial, fundamental para os cálculos de variação de seções de choque.
Supondo uma malha para todo o núcleo do reator TRIGA, são vários as regiões definidas como combustível, por exemplo.
uma região da malha, por exemplo o combustível,
seja formada por células não conectadas, apenas a primeira região é encontrada pelo algoritmo de . Este \textit{bug} tornou
inviável a simulação, dentro da metodologia proposta, de mais de um elemento combustível
\footnote{Durante a execução desta tese, alguns \textit{bugs} encontrados no \textit{milonga} foram corrigidos e
  reportados ao seu autor. Uma das correções acabou com um vazamento em memória que impedia que o \textit{milonga}
  fosse executado mais do que alguns vezes em modo iterativo.}.

%Com estas limitações em mente, nas próximas seções será apresentado o modelo utilizado com todas as suas
%características bem como os parâmetros utilizados nas simulações neutrônica e termo-hidráulica.

\section{Modelo: características}
%
% IMPORTANTE
%
% Separo th de neutronica em seções para colocar as seções de choque antes da neutrônica?
% Ou coloco logo as seções de choque antes de tudo?

Nesta seção é descrito o modelo físico e numérico utilizado nos testes do sistema acoplado.
De modo a verificar o efeito das variações de temperatura calculados pela termo-hidráulica
no fluxo neutrônico e, por consequência, no perfil de potência, é necessário ter seções
de choque compatíveis com o problema. A Figura \ref{fig:modelo_exploded} apresenta a malha
utilizada por ambos os códigos indicando cada região. Cada uma das regiões define um
material diferente, no caso: combustível, revestimento e água. A próxima seção descreve
a metodologia utilizada para geração de seções de choque. 

\begin{figure}[htb]
  \caption{Modelo: regiões e materiais. Em vermelho, combustível. Em amarelo, revestimento.
  em ciano, o refrigerante/moderador}
  \centering\includegraphics[scale=0.5]{figuras/regioes_surface2.png}
  \label{fig:regions}
%  \legend{Fonte: autor}
\end{figure}

\section{Geração de seções de choque}

A fim de verificar o impacto das variações de temperatura calculadas pelo \textit{OpenFOAM} no fluxo
neutrônico e, portanto, na potência volumétrica, foram geradas seções de choque correspondentes
ao modelo utilizado.

% Não tem figura, ela fez anel anel anel
%Na figura \ref{fig:modelwims}

As seções de choque geradas são usadas como os coeficientes da equação de difusão, como já mencionado.
A tabela \ref{tab:coeff-dif} apresenta o significado dos mnemônicos utilizados pelo \textit{milonga}
bem como a divisão de grupos em energias.

% Tabela para os valores
\begin{table}[htb]
  \caption[Coeficientes da Equação de Difusão.]{Coeficientes da Equação de Difusão.}
  \label{tab:coeff-dif}
  \begin{tabular}{ l | c | r}
  \hline
  \multicolumn{3}{ c }{Coeficientes Mnemônicos} \\
  \hline
  \multirow{4}{*}{Grupo 1: > 0,625 MeV} & Diffusion coefficient & $D1$\\
& Absorption cross-section & $\Sigma A1$\\
& Scattering cross-section & $\Sigma S1.2$\\
  & Neutrons per fission * Fission cross-section & $\nu \Sigma F1$\\
  \hline
\multirow{3}{*}{Grupo 2: < 0,625 MeV} & Diffusion coefficient & $D2$\\
& Absorption cross-section & $\Sigma A2$\\
& Neutrons per fission * Fission cross-section & $\nu \Sigma F2$ \\
\hline
\end{tabular}
\end{table}

Um modelo bidimensional com propriedades equivalentes ao modelo tridimensional a ser simulado
foi definido. Esta equivalência foi garantida mantendo-se a proporção entre material
físsil e moderador em ambos os modelos. Com base nessa proporção,
todos os materiais foram definidos como anéis concêntricos. Geometria definida,
foram geradas seções de choque para quatro diferentes temperaturas, desde
a temperatura ambiente até a temperatura próxima a máxima do combustível do TRIGA IPR-R1 em operação
a $250 kW$ \cite{Veloso2005}. A metodologia utilizada para a geração
das seções de choque considerou as condições do reator TRIGA IPR-R1 no
ano de 2004, sendo utilizado o código WIMSD-5B neste processo \cite{Reis2015}.
As temperaturas utilizadas na geração das seções de choque
e as seções de choque resultantes são apresentadas nas tabelas \ref{tab:temp-fuel},
\ref{tab:temp-cladding} e \ref{tab:temp-coolant} respectivamente para o combustível, revestimento
e moderador.


\begin{table}[htb]
  \caption[Temperaturas para combustível.]{Temperaturas para o combustível}.
  \label{tab:temp-fuel}
  \begin{tabular}{r l l l l}
  \multicolumn{5}{c}{Fuel} \\
  \hline
  Parâmetro & $300K$ & $400K$ & $500K$ & $600K$ \\
  \hline
  $D1$ & 0.0108349 & 0.0108521 & 0.0108489 & 0.010846\\
  $\Sigma A1$ & 0.771135 & 0.783626 & 0.795686 & 0.806567\\
  $\Sigma S1.2$ & 3.3991 & 3.4329 & 3.4264 & 3.4206\\
  $\nu \Sigma F1$ & 0.500982 & 0.500304 & 0.500377 & 0.500441\\
  \hline
  $D2$ & 0.00314942 & 0.0031682 & 0. 0032163 & 0.0032743 \\
  $\Sigma A2$ & 11.0389 & 10.8142 & 10.4004 & 9.90199\\
  $\nu \Sigma F2$ & 20.1943 & 19.7703 & 18.9898 & 18.0499\\
  \hline
\end{tabular}
\end{table}

\begin{table}[htb]
  \caption[Temperaturas para o revestimento.]{Temperaturas para o revestimento}.
  \label{tab:temp-cladding}
  \begin{tabular}{r l l l l}
    \multicolumn{5}{c}{Revestimento} \\
    \hline
    Parâmetro & $300K$ & $396K$ & $403K$ & $410K$ \\
    \hline
    $D1$ & 0.0299644 & 0.0299699 & 0.0299678 & 0.0299659 \\
    $\Sigma A1$ & 0.0288617 & 0.028926 & 0.0289199 & 0.0289143 \\
    $\Sigma S1.2$ & 3.3991 & 3.4329 & 3.4264 & 3.4206\\
    \hline
    $D2$ & 0.0376276 & 0.0376721 & 0.0377696 & 0.0379140\\
    $\Sigma A2$ & 0.874322 & 0.865956 & 0.846858 & 0.818690\\
    \hline
  \end{tabular}
\end{table}

\begin{table}[htb]
  \caption[Temperaturas para o refrigerante.]{Temperaturas para o refrigerante}.
  \label{tab:temp-coolant}
  \begin{tabular}{r l l l l}
    \multicolumn{5}{c}{Moderador} \\
    \hline
    Parâmetro & $300K$ & $308.5K$ & $317K$ & $341K$ \\
    \hline
    $D1$ & 0.0126587 & 0.0126685 & 0.0126696 & 0.0126705\\
    $\Sigma A1$ & 0.0290925 & 0.0292130 & 0.0292018 & 0.0291917\\
    $\Sigma S1.2$ & 3.3991 & 3.4329 & 3.4264 & 3.4206\\
    \hline
    $D2$ & 0.00213616 & 0.0021262 & 0021368 & 0021589\\
    $\Sigma A2$ & 1.42651 & 1.41891 & 1.39505 & 1.35409\\
    \hline
  \end{tabular}
\end{table}

Uma limitação do código WIMSD-5B está na geração de seções de choque de espalhamento
para cada material separadamente. Devido a esta restrição, as seções de choque de
espalhamento foram geradas para uma homogeneização dos materiais em uma única célula,
sendo esta a razão dos valores serem os mesmos para todos os materiais.


%
% IMPORTANTE: Talvez este próximo parágrafo não deva ficar aqui, mas no modelo da neutrônica.
%
As seções de choque obtidas foram então escritas no formato \textit{milonga} como
funções de uma variável dependentes da temperatura. Como o milonga tem informação
das células em relação à malha, a temperatura de cada célula é argumento da
função de uma variável dependente da temperatura. Se a temperatura não está
exatamente tabulada, o \textit{milonga} provê interpolação linear por padrão.

\section{Modelo físico e numérico}
\label{sec:mod_fis_num}

O modelo escolhido, de acordo com as limitações em termos
de \textit{software} apresentadas na início deste capítulo, representa um
elemento combustível do reator TRIGA IPR-R1, ainda operacional, localizado
no CDTN. O combustível do TRIGA possui uma grande sensibilidade na sua
reatividade com a temperatura devido à presença do hidreto de zircônio
em sua constituição. Essa característica intrínseca permite que pequenas
variações nas suas temperaturas levem a variações perceptíveis na neutrônica,
o que torna este modelo interessante para avaliação do acoplamento.

\begin{figure}[htb]
  \caption{Discretização do modelo: regiões e materiais.}
  \centering\includegraphics[scale=0.5]{figuras/regioes_edges_com_legenda_ingles.png}
  \label{fig:modelo_exploded}
%  \legend{Fonte: autor}
\end{figure}

O modelo consiste num combustível com revestimento de alumínio sem
o \textit{gap}, de modo que o diâmetro do combustível é mantido como no
combustível de referência e o diâmetro do \textit{gap} é estendido para
ocupar este espaço. Além disso, o modelo considera apenas o comprimento
ativo do combustível, sendo como um combustível mais curto. O volume
de água ao redor do combustível foi modelada considerando a razão entre
material físsil e moderador do núcleo completo do reator. Nenhuma outra
estrutura sólida, como discos de samário ou elementos estruturais, é
respresentada no modelo, sendo este idêntico axialmente em qualquer
altura, como observável na Figura \ref{fig:modelo_exploded}.

\begin{table}[htb]
\centering
  \caption[Medidas do modelo.]{Medidas do modelo.}
  \label{tab:size_model}
  \begin{tabular}{r l}
    Estrutura & $[cm]$ \\
    \hline
    Raio do combustível & 1.78 \\
    Raio externo do revestimento & 1.865 \\
    Arestas do refrigerante/moderador & 4.57 \\
    \hline
    Altura axial & 35.0 \\
    \hline
  \end{tabular}
\end{table}

A malha gerada para o modelo foi construída por extrusão. Isso significa que
Os elementos de malha foram gerados para uma superfície e a dimensão espacial
foi dada por um valor de comprimento além do número de camadas a serem geradas.
Foram geradas 35 camadas (cada uma com um $cm$), sendo o tamanho relativo
mínimo para elemento de malha de 0,5 e máximo de 4.0. Esses valores constrolam
o quanto o elemento próximo ao ponto com tal tamanho relativo crescerá durante
a geração da malha. A razão de crescimento entre o refinamento do revestimento
e as áreas restantes foi estabelecido em 1,2. Com isso, foi possível conseguir
elementos suficientemente pequenos para realizar os cálculos na região
do revestimento e ainda obter uma malha com tamanho tratável pelo \textit{milonga}.
A malha gerada tem 346.675 elementos.

As dimensões da malha do modelo geram implicações nos resultados dos cálculos, em
especial a pequena granularidade axial (35 camadas). Entretanto, mesmo com tais
limitações, impostas pelo \textit{milonga}, é possível utilizá-la para verificar
as diferenças entre um sistema não acoplado e outro acoplado.


\subsection{Condições de contorno e parâmetros numéricos da termo-hidráulica}
\label{subsec:ccth}

São quatro condições de contorno utilizadas na solução da simulação termo-hidráulica.
As extremidades do combustível e do revestimento são definidas como adiabáticas. Nas
extremidades da região do refrigerante, são definidos entrada (\textit{inlet}) e
saída (\textit{outlet}) para o escoamento. As laterais do modelo são definidas
como simétricas. Na figura \ref{fig:ccth} são mostradas as condições de contorno
utilizadas e as regiões correspondentes. As regiões sólidas são assim representadas
enquanto a região do modelo correspondente ao fluido é representada como malha.

\begin{figure}[htb]
  \caption{Modelo: condições de contorno da simulação termo-hidráulica e regiões
    correspondentes. As superfícies definidas como simétricas estão em vermelho
    enquanto em azul estão a entrada e saída de fluido. A região sólida representa
    o combustível e revestimento, ambos com condiçoes de contorno adiabáticas nas
  extremidades.}
  \centering\includegraphics[scale=0.5]{figuras/inlet_paredes_extremos_wireframe2.png}
  \label{fig:ccth}
%  \legend{Fonte: autor}
\end{figure}

As superfícies entre regiões têm suas condições de contorno definidas automaticamente
num dos passos da etapa de pré-processamento. Por definição, o \textit{OpenFOAM} importa
a malha num único conjunto de elementos, armazenando as definições de regiões
contidas na malha. Um dos utilitários disponibilizados pelo \textit{OpenFOAM} separa
as regiões, gerando condições de contorno em cada uma das regiões que representam
as interfaces entre regiões. Outro utilitário é utilizado em seguida para definir valores
para os parâmetros das respectivas condições de contorno.

% Colocar um exemplo aqui?
% Ou uma figura?

